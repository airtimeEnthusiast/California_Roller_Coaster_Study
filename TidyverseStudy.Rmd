---
title: "2021 California \nCoasters Study"
author: "Written by Austin Wright"
date: "11/10/2021"
output: learnr::tutorial
runtime: shiny_prerendered
---

```{r setup, include=FALSE}
library(learnr)
library(tidyverse)
library(ggplot2)
library(plotly)
library(htmlwidgets)
library(plyr)
library(reshape2)
library(data.table)
knitr::opts_chunk$set(echo = FALSE)
options(warn=-1)
```



## Background and Purpose
<center> 
I created my own data set and verified various sources such as [RCDB](https://rcdb.com) and [Ultimate Coaster](https://www.ultimaterollercoaster.com) and compiled many verifiable stats such as Height, Speed, Location and Length. However I did not end up using all the stats due to time constraints. I don't really emphasize smaller coasters since I have no interest and have missing information.
```{r Load-df}
rawDataFrame <- "./data/ca_data_region.csv"
currentDataFrame <- read.csv(rawDataFrame)
currentDataFrame
```

### Intro
Ever since I was tall enough to go on a thrilling roller coaster, they have been a relatively interesting hobby for many reasons besides the wonderful rush of adrenaline. Roller Coasters are great models of reality such as mechanical engineering, control theory and have various characteristics for statistical analysis. In high school I operated a few large scale coasters at my home regional park so I have some insight from an operational perspective. In this report I choose to focus on roller coasters within the state of California because it is currently the state with the most roller coasters about 93 and have ridden all of the major coasters outside of Sea World. Some stats were easier to find such as height, speed, inversion count, manufacture, and manufacture model name/type. However other figures such as capacity and ride duration were a bit inconsistent between sources and other mechanical factors like temperature. This is much more of a "Fun" project then a scientific analysis of roller coasters since the subject is quite subjective 

### Data Resources
I reference these two websites frequently for information:
|[RCDB](https://rcdb.com)  |
|[Ultimate Coaster](https://www.ultimaterollercoaster.com) |


### Section
|   |                                                       |
|:--|:------------------------------------------------------| 
|A. | General Stats Compared                                |
|B. | Brief Historical Moments                              |
|C. | Favorites Compared                                    |


### Data Dictionary
| Term                           | Type                   | description                                                                                                                             |
|:-------------------------------|:-----------------------|:----------------------------------------------------------------------------------------------------------------------------------------|
| RCDB                           | [Database](https://rcdb.com) | Website with a large database of coasters stats                                                                                   |
| Ultimate Coaster               | [Database](https://www.ultimaterollercoaster.com) | Website with a large database of coaster stats, photos and catagorically filter data                         |
| Six Flags                      | Cooperate Chain        | The largest US theme park operator and own two parks in California (Magic Mountain, Discovery Kingdom)                                  |                           
| Cedar Fair                     | Cooperate Chain        | Owner  of California's Great America, Knott's Berry Farm and Gilroy Gardens                                                             |
| Sea World                      | Cooperate Chain        | Owner of Sea World San Diego                                                                                                            |
| Disney                         | Cooperate Chain        | Owner of California Adventure and Disneyland                                                                                            |
| Universal Studios              | Cooperate Chain        | Owner of Universal Studios Hollywood                                                                                                    |
| Merlin Entertainment           | Cooperate Chain        | Owner of Legoland California                                                                                                            |
| Wood                           | Roller Coaster Type    | A coaster which has wood track, supports and is typically incapable of inversions.                                                      |
| Steel                          | Roller Coaster Type    | A coaster constructed out of steel supports and steel track typically capable of inversions.                                            |
| Hybrid                         | Roller Coaster Type    | A coaster constructed out of wood supports and steel track typically capable of inversions.                                             |
| Multi-Looper                   | Roller Coaster Layout  | A coaster with a focus on postive g-forces and inversions                                                                               |
| Twister                        | Roller Coaster Layout  | A coaster with a focus on large curves and lateral g-forces                                                                             |
| Hyper                          | Roller Coaster Layout  | A coaster within the height bounds of greater than 199ft and less than 300ft                                                            |
| Giga                           | Roller Coaster Layout  | A coaster within the height bounds of greater than 300ft and less than 400ft                                                            |
| Strata                         | Roller Coaster Layout  | A coaster within the height bounds of greater than 400ft and less than 500ft                                                            |
| Inversion                      | Coaster Element        | A section of coaster track where the roller coaster riders will be turned upside down. Elements like vertical loops and corkscrews.     |
| Vertical Loop                  | Coaster Element        | An inversion shaped as a vertically standing "clothoid" loop.                                                                           |
| Corkscrew                      | Coaster Element        | An elongated vertical loop.                                                                                                             |
| Positive G-Force               | Coaster Element        | A section of track which produces high centripetal acceleration making riders feel heavy and can cause gray outs in many cases.         |
| Airtime                        | Coaster Element        | A section of coaster track where the roller coaster riders will experience less than zero or equal vertical G-Force.                    |
| Great Coasters International   | Manufacturer           | Specialize in only wooden coasters which typically have banked turns in a "twister" style track layout.                                 |
| Bollinger & Mabillard          | Manufacturer           | Builder of steel coasters with their signature box track for their high reliability, smoothness and high inversion count.               |
| Intamin                        | Manufacturer           | An Industry leader with many coasters first's of it's kind designs and record breaking stats.                                           |
| Premier Rides                  | Manufacturer           | Specializes in launch coasters and developed the first coaster to use a [LIM](https://en.wikipedia.org/wiki/Linear_induction_motor) proposition mechanism.|
| Mack Rides                     | Manufacturer           | Manufacture of steel launch coasters and spinning coasters.                                                                             |
| Schwarzkopf                    | Manufacturer           | Defunct manufacture that was an industry leader in the late 70s to late 80s in steel looping coasters.                                  |
| Arrow Development              | Manufacturer           | Defunct manufacture that was an industry leader pioneering the first steel tubular, inverting and 200ft+ tall coaster.                  |
| E&F Miller                     | Manufacturer           | Defunct manufacture of small scale steel family and kid friendly coasters.                                                              |
| Wisdom Rides                   | Manufacturer           | Known for their [Gravitation](https://en.wikipedia.org/wiki/Gravitron) flat-rides, they also have produced many Dragon Wagon coasters.  |
| Wiegand                        | Manufacturer           | Leader of creating alpine style coasters for ski resorts.                                                                               |
| Zamperla                       | Manufacturer           | Large player of designing flat-rides have a recent history of building steel coasters.                                                  |
| D.H Morgan                     | Manufacturer           | Defunct manufacture started by son of one of the founders of Arrow Development, specialized in steel coasters.                          |
| Rocky Mountain Construction    | Manufacturer           | Manufacture with recent widespread popularity with their cost effective hybrid wood supports and steel roller coaster technology.       |
| Maurer                         | Manufacturer           | Manufacture in portable steel spinning roller coasters.                                                                                 |
| Dynamic Attractions            | Manufacturer           | Manufacture of specialized ride systems for Disney and Universal Studios.                                                               |
| Fabbri                         | Manufacturer           | Manufacture in portable flat rides and portable spinning coasters.                                                                      |
| Giovanola                      | Manufacturer           | Manufacturer which had a short history of manufacturing.                                                                                |
| Allan Herschell                | Manufacturer           | Defunct manufacture of small children roller coasters.                                                                                  |
| Vekoma                         | Manufacturer           | Manufacture known for their notorious [Boomerang coasters.](https://en.wikipedia.org/wiki/Boomerang_(roller_coaster))                   |
| Custom Coaster International   | Manufacturer           | Defunct manufacture of wooden coasters whose staff split and formed GCI and Gravity Group.                                              | 
| Gravity Group                  | Manufacturer           | Manufacture known for airtime focused wooden coasters however have not built a single coaster in CA.                                    |
| Frank Prior, Fredrick Church   | Manufacturer           | Coaster Designers of many late classic wooden coasters at the beginning of the 20th century.                                            |
| Zierer                         | Manufacturer           | Manufacture known for their [Wave-swinger](https://en.wikipedia.org/wiki/Swing_ride) flat ride   |

```{r mode, freq, iterator, functions}
# https://stackoverflow.com/questions/8545590/find-the-most-popular-element-in-int-array
# https://stackoverflow.com/questions/5738831/r-plus-equals-and-plus-plus-equivalent-from-c-c-java-etc
# Below are some functions for the next section 


getmode <- function(v) {
   uniqv <- unique(v)
   uniqv[which.max(tabulate(match(v, uniqv)))]
}


count <- 0
inc <- function(count)
{
 eval.parent(substitute(count <- count + 1))
}

#Frequency of a column
countMode <- function(catagory){
  previous <- catagory[1]
  popular <- catagory[1]
  maxCount <- 1
  for (i in 1 : length(catagory)) {
    if(previous == catagory[i]){
     inc(count)
    }
    else{
        if(count > maxCount){
          popular <- catagory[i - 1]
          maxCount = count;
        }
    }
  }
  return <- maxCount
}


```


## General Population 
<Center>
First I wanted to graph the recorded speed and height of all coasters in my data set between Southern California and Northern California to see where there is more substantial investment. 
```{r Existant Coasters statisical breakdowns}

# Speed Versus Height of Southern California Coasters
scatterPlot <- currentDataFrame %>% filter(Region == "S") %>%
  ggplot(width = 700, height = 700,mapping = aes(x = Speed, y = Height, 
             text = paste(
             Name, " at ", Park, "\n", 
                "Description: ", Type ,"", Model.Name, "\n",
                "Built by", Manufacturer, " in ", Year,"\n",
             Speed, " mph\n",
             Height, " ft tall\n"))) +
  geom_point(aes(color = Type)) + 
  labs(x = "Speed", 
       y = "Height",
       title = "Speed Versus Height of SoCal Coasters") +
  geom_hline(yintercept=0, linetype="dashed", color = "#000000", size=0.5) + geom_vline(xintercept=0, linetype="dashed", color = "#000000", size=0.5) 

ggplotly(scatterPlot, tooltip = "text")


# Speed Versus Height of Northern California Coasters
scatterPlot2 <- currentDataFrame %>% filter(Region == "N") %>%
  ggplot(width = 700, height = 700,mapping = aes(x = Speed, y = Height, 
             text = paste(
             Name, " at ", Park, "\n", 
                "Description: ", Type ,"", Model.Name, "\n",
                "Built by", Manufacturer, " in ", Year,"\n",
             Speed, " ft long\n",
             Height, " ft tall\n"))) +
  geom_point(aes(color = Type)) + 
  labs(x = "Speed", 
       y = "Height",
       title = "Speed Versus Height of NorCal Coasters") +
  geom_hline(yintercept=0, linetype="dashed", color = "#000000", size=0.5) + geom_vline(xintercept=0, linetype="dashed", color = "#000000", size=0.5) 

ggplotly(scatterPlot2, tooltip = "text")


```

<center>
Not only does Southern California have more coasters but they are much larger with [Superman Escape](https://rcdb.com/140.htm) being the third tallest coaster in the world. Southern California also has all three state's hyper coasters. 
</center>


```{r Population Perctange}

# Subsetting Number of Coasters between regions 
SoCalSubset <- subset(currentDataFrame, subset=((Region == "S")))
NorCalSubset <- subset(currentDataFrame, subset=((Region == "N")))

socal <- c(length(SoCalSubset$Name))   #SoCal Population

norcal <- c(length(NorCalSubset$Name)) #NorCal Population

 s <- (socal/(socal+norcal)*100.0) 
 n <- (norcal/(socal+norcal)*100.0)
s = round(s, digits=0)
n = round(n, digits=0)

percentages <-c(s,n)
                  
populations <- c(socal, norcal)
regions <- c("SoCal","NorCal")
df = data.frame(matrix(ncol = 2, nrow = 2))

#A bit unconfidential df
colnames(df) <- regions
rownames(df) <- populations

#Pie Chart
piePlot <- ggplot(df, aes(x = "", y = populations, fill = regions)) +
  geom_col() +
  coord_polar(theta = "y",start=0) +  geom_text(aes(label = percentages),
            position = position_stack(vjust = 0.5)) + ggtitle("California Population Percentage")

piePlot


```

<center>
Southern California without a doubt has more coasters but will later show that they do not lack quality 
</center>
## Brief Historical Moments
### The Santa Cruz Dipper 1924
Roller Coasters grew ever so popular around the turn of the Century in the US. The two classic Giant Dippers are the two California Classics both Designed by the legendary Frank Prior and Fredrick Church. However many disappeared post 1929 until a renaissance occurred beginning in the 1950s
<center>
![](https://blog.beachboardwalk.com/sites/bw-news/files/ndmblog028_img005_1925_GiantDipper_001.jpg){width=98%}
Santa Cruz's Giant Dipper features more of an out and back style layout with airtime hills. My favorite highlight especially this innocent looking drop I call ["The Ejector Hill"](https://youtu.be/ZmZvKYtc7g0?t=130)
![](./data/EjectorHill.png){width=60%}
The steepness of this hill gives an incredible pop of airtime.   
![](https://www.youtube.com/watch?v=ZmZvKYtc7g0){width=90%}
</center>
### The San Diego Dipper 1925
![](https://1.bp.blogspot.com/-pXD0dNvIuEI/Xv-J4nV9kwI/AAAAAAAAqTY/Jc7L1QXVWE88mrfDBF3_kLP6_Dzl9OWbgCLcBGAsYHQ/s640/8pq4w0w4myi21.jpg){width=110%}
Also built by Frank Prior and Fredrick Church, San Diego's Giant Dipper Belmont Park focuses more on lateral forces with low banked curves and drops in a twister style layout
![](https://www.youtube.com/watch?v=HDOFjwnbIws){width=90%}

### The Dippers Compared

```{r The Dippers}
# Speed Versus Height of the Dippers
Targets <- c("Belmont Giant Dipper","Santa Cruz Giant Dipper")
scatterPlot <- currentDataFrame %>% filter(Name %in% Targets)  %>%
  ggplot(width = 200, height = 200,mapping = aes(x = Speed, y = Height, 
             text = paste(
             Name, " at ", Park, "\n", 
                "Description: ", Type ,"", Model.Name, "\n",
                "Built by", Manufacturer, " in ", Year,"\n",
             Speed, " mph\n",
             Height, " ft tall\n"))) +
  geom_point(aes(color = Name)) + 
  labs(x = "Speed", 
       y = "Height",
       title = "Speed Versus Height of the Dippers") +
  geom_hline(yintercept=0, linetype="dashed", color = "#000000", size=0.5) + geom_vline(xintercept=0, linetype="dashed", color = "#000000", size=0.5) 

ggplotly(scatterPlot, tooltip = "text")
```
The two coasters are extremely similar stats wise but have very different ride layouts 
</center>

### The Disney Innovation 
Inspired from his last film Third Man on the Mountain, Walt Disney had the ambition to build first tubular steel track roller coasters in the form of the Matterhorn Bobsleds. Manufactured by Arrow Development, this contractor would go on to design many early Disney dark ride systems and become a [dominante](https://www.youtube.com/watch?v=rGKgVxx5Wu8) player in the roller coaster industry. The use of tubular steel running rails are is still the most common way coaster track is designed.
<center>
![](http://2.bp.blogspot.com/-YHu7X6pcpGA/Tlp7czLTphI/AAAAAAAAAOA/Rm1qkCpSEO4/s320/matterhornbobsled.jpg){width=45%}
![](https://upload.wikimedia.org/wikipedia/commons/thumb/4/4c/Matterhorndisney.jpg/800px-Matterhorndisney.jpg){width=40%}
![](https://www.youtube.com/watch?v=6VGNdjgFKTA){width=90%}
</center>
### Thrown For A Loop  
1975 not only was a big year with the opening of space mountain but  down the street from Disneyland, Knott's Berry Farm would debut Arrow's corkscrew prototype which was the world's first successful inverting roller coaster 
![](http://www.itsasmallworldblog.com/uploads/5/8/3/9/5839250/screenshot-2020-09-17-22-26-00-2_orig.png){width=110%}
Knott's Corkscrew was relocated to Silverwood Idaho still stands as living history

![](https://www.youtube.com/watch?v=3NbQoSMx0d0){width=90%}
The Northern California rival, Marriott Great America would open Turn of the Century another Arrow Corkscrew with a custom out and back layout.
![](https://www.themeparkreview.com/parks/pimages/Californias_Great_America/Turn_of_the_Century/toc002.jpg)
Turn of the Century* now known as the [Demon](https://rcdb.com/76.htm) was the second Arrow Corkscrew variant.
![](https://www.youtube.com/watch?v=YJod9tuFYl4)
The coaster for the 1980 season scrap the airtime hills in favor of vertical loops, a light tunnel and themed rock-work.
![](https://i0.wp.com/www.greatamericaparks.com/wp-content/uploads/2018/03/demon-130802-0001.jpg?resize=2000%2C1200&ssl=1){width=90%}
That same year Anton Schwarzkopf would build the Revolution for Six Flags Magic Mountain and feature the first steel vertical loop.
![](http://www.thecoasterguy.com/wordpress/wp-content/gallery/revolution/sfmm_revolution_51.jpg)
This coaster marked the beginning of Magic Mountain dominating the coaster market in California with many record breakers.
![](https://i.pinimg.com/originals/66/f9/62/66f962f53b0fb785a205aea851127fa2.jpg)
![](https://www.youtube.com/watch?v=aMDAoaCyB1c)
</center>

### Demon vs. Revolution
```{r Inversion Study}
# Inversions Versus Model.Name
Targets <- c("Demon","Revolution")
barPlot <- currentDataFrame %>% filter(Name %in% Targets)  %>%
  ggplot(width = 200, height = 200,mapping = aes(x = Manufacturer, y = Num.of.Inversions, 
             text = paste(
             Name, " at ", Park, "\n", 
                "Description: ", Type ,"", Model.Name, "\n",
                "Built by", Manufacturer, " in ", Year,"\n",
             Speed, " mph\n",
             Height, " ft tall\n"))) +
  geom_bar(stat="identity", fill= "blue", position=position_dodge()) + 
  labs(x = "Manufacturer", 
       y = "Inversions #",
       title = "Inversion Comparrison") +
  geom_hline(yintercept=0, linetype="dashed", color = "#000000", size=0.5) + geom_vline(xintercept=0, linetype="dashed", color = "#000000", size=0.5) 

ggplotly(barPlot, tooltip = "text")
```

```{r Height and Speed}
# Speed Versus Height
Targets <- c("Demon","Revolution")
scatterPlot <- currentDataFrame %>% filter(Name %in% Targets)  %>%
  ggplot(width = 200, height = 200,mapping = aes(x = Speed, y = Height, 
             text = paste(
             Name, " at ", Park, "\n", 
                "Description: ", Type ,"", Model.Name, "\n",
                "Built by", Manufacturer, " in ", Year,"\n",
             Speed, " mph\n",
             Height, " ft tall\n"))) +
  geom_point(aes(color = Name)) + 
  labs(x = "Speed", 
       y = "Height",
       title = "Speed Versus Height") +
  geom_hline(yintercept=0, linetype="dashed", color = "#000000", size=0.5) + geom_vline(xintercept=0, linetype="dashed", color = "#000000", size=0.5) 

ggplotly(scatterPlot, tooltip = "text")
```

### Stats Before 1980
```{r Before 1980 Stats}

#Speed Historgram
filteredDataFrame <- currentDataFrame %>% filter(Year <= 1980)
barplot <- ggplot(data = filteredDataFrame, width = 700, height = 700,mapping = aes(x = Year, y = Speed, 
             text = paste(
             Name, " at ", Park, "\n", 
                "Description: ", Type ,"", Model.Name, "\n",
                "Built by", Manufacturer, " in ", Year,"\n",
             Speed, " mph\n"))) + geom_bar(stat="identity", color= "orange", position=position_dodge()) + labs(title = "Speed Historgram Berfore 1980")
ggplotly(barplot, tooltip = "text") 

#Height Historgram
filteredDataFrame <- currentDataFrame %>% filter(Year <= 1980)
barplot <- ggplot(data = filteredDataFrame, width = 700, height = 700,mapping = aes(x = Year, y = Height, 
             text = paste(
             Name, " at ", Park, "\n", 
                "Description: ", Type ,"", Model.Name, "\n",
                "Built by", Manufacturer, " in ", Year,"\n",
             Height, " ft\n"))) + geom_bar(stat="identity", color= "red", position=position_dodge()) + labs(title = "Height Historgram Before 1980")
ggplotly(barplot, tooltip = "text") 

#Length Historgram
filteredDataFrame <- currentDataFrame %>% filter(Year <= 1980)
barplot <- ggplot(data = filteredDataFrame, width = 700, height = 700,mapping = aes(x = Year, y = Length, 
             text = paste(
             Name, " at ", Park, "\n", 
                "Description: ", Type ,"", Model.Name, "\n",
                "Built by", Manufacturer, " in ", Year,"\n",
             Length, " ft\n"))) + geom_bar(stat="identity", color= "blue", position=position_dodge()) + labs(title = "Length Historgram Before 1980")
ggplotly(barplot, tooltip = "text") 


filteredDataFrame <- currentDataFrame %>% filter(Year <= 1980)
barplot <- ggplot(data = filteredDataFrame, width = 700, height = 700,mapping = aes(x = Year, y = Length, 
             text = paste(
             Name, " at ", Park, "\n", 
                "Description: ", Type ,"", Model.Name, "\n",
                "Built by", Manufacturer, " in ", Year,"\n",
             Length, " ft\n"))) + geom_bar(stat="identity", color = "green") + labs(title = "Length Historgram Before 1980")
ggplotly(barplot, tooltip = "text") 


```

## After 1980
Arrow and Schwarzkopf would continue to provide new and innovative coasters to the parks in California. 
![](https://upload.wikimedia.org/wikipedia/commons/b/b6/Viper_queue_view.jpg)
The 1990 Viper opened with  the record for the most inversions on any coaster
![](https://upload.wikimedia.org/wikipedia/commons/thumb/2/24/Riddlers_Revenge_13.jpg/800px-Riddlers_Revenge_13.jpg)
<center>
 By the 80's steel coasters were the norm with many of them focusing on inversion count as evident by 
</center>
![](https://youtu.be/410y0gGpj9I?t=56)
![](https://sf-static.sixflags.com/wp-content/uploads/2020/04/sfmm_superman_escape_from_krypton_1440x1533-1-768x818.jpg)
![](https://youtu.be/rfi7PAQj7jg?t=25)
```{r After 1980 Stats}
# Speed Historgram
filteredDataFrame <- currentDataFrame %>% filter(Year >= 1980)
barplot <- ggplot(data = filteredDataFrame, width = 700, height = 700,mapping = aes(x = Year, y = Speed, 
             text = paste(
             Name, " at ", Park, "\n", 
                "Description: ", Type ,"", Model.Name, "\n",
                "Built by", Manufacturer, " in ", Year,"\n",
             Speed, " mph\n"))) + geom_bar(stat="identity", fill= rainbow(63)) + labs(title = "Speed Historgram After 1980")
ggplotly(barplot, tooltip = "text") 

# Height Historgram
filteredDataFrame <- currentDataFrame %>% filter(Year >= 1980)
barplot <- ggplot(data = filteredDataFrame, width = 700, height = 700,mapping = aes(x = Year, y = Height, 
             text = paste(
             Name, " at ", Park, "\n", 
                "Description: ", Type ,"", Model.Name, "\n",
                "Built by", Manufacturer, " in ", Year,"\n",
             Speed, " ft\n"))) + geom_bar(stat="identity", fill= rainbow(65)) + labs(title = "Height Historgram After 1980")
ggplotly(barplot, tooltip = "text") 

# Length Historgram
filteredDataFrame <- currentDataFrame %>% filter(Year >= 1980)
barplot <- ggplot(data = filteredDataFrame, width = 700, height = 700,mapping = aes(x = Year, y = Length, 
             text = paste(
             Name, " at ", Park, "\n", 
                "Description: ", Type ,"", Model.Name, "\n",
                "Built by", Manufacturer, " in ", Year,"\n",
             Speed, " ft\n"))) + geom_bar(stat="identity", fill= rainbow(62)) + labs(title = "Length Historgram After 1980")
ggplotly(barplot, tooltip = "text") 

```



```{r}
  filteredDataFrame <- currentDataFrame %>% filter(Height >= 140 & Year >= 1980)
  barplot <- ggplot(data = filteredDataFrame, width = 700, height = 700,mapping = aes(x = Year, y = Height, 
             text = paste(
             Name, " at ", Park, "\n", 
                "Description: ", Type ,"", Model.Name, "\n",
                "Built by", Manufacturer, " in ", Year,"\n",
             Height, " ft \n"))) + geom_bar(stat="identity", fill= rainbow(16)) + labs(title = "Coasters over 140ft After 1980")
  ggplotly(barplot, tooltip = "text")
```

## Comparing Significant Coaster after 1980
```{r Focus on Coasters After 1980}
# Coasters over 140ft (>1980)
filteredDataFrame <- currentDataFrame %>% filter(Height >= 140 & Year >= 1980)
barplot <- ggplot(data = filteredDataFrame, width = 700, height = 700,mapping = aes(x = Year, y = Height, 
             text = paste(
             Name, " at ", Park, "\n", 
                "Description: ", Type ,"", Model.Name, "\n",
                "Built by", Manufacturer, " in ", Year,"\n",
             Height, " ft \n"))) + geom_bar(stat="identity", fill= rainbow(16)) + labs(title = "Coasters over 140ft After 1980")
ggplotly(barplot, tooltip = "text")


# Coasters under 140ft over 50ft (>1980)
filteredDataFrame <- currentDataFrame %>% filter(Height <= 140 & Height >= 50 & Year >= 1980)
barplot <- ggplot(data = filteredDataFrame, width = 700, height = 700,mapping = aes(x = Year, y = Height, 
             text = paste(
             Name, " at ", Park, "\n", 
                "Description: ", Type ,"", Model.Name, "\n",
                "Built by", Manufacturer, " in ", Year,"\n",
             Height, " ft \n"))) + geom_bar(stat="identity", fill= rainbow(24)) + labs(title = "Coasters under 140ft over 50ft After 1980")
ggplotly(barplot, tooltip = "text")


# Coasters over 50 mph (>1980)
filteredDataFrame <- currentDataFrame %>% filter(Speed >= 50 & Year >= 1980)
barplot <- ggplot(data = filteredDataFrame, width = 700, height = 700,mapping = aes(x = Year, y = Speed, 
             text = paste(
             Name, " at ", Park, "\n", 
                "Description: ", Type ,"", Model.Name, "\n",
                "Built by", Manufacturer, " in ", Year,"\n",
             Speed, " mph\n"))) + geom_bar(stat="identity", fill= rainbow(30)) + labs(title = "Coasters over 50 mph After 1980")
ggplotly(barplot, tooltip = "text") 

```



## Inversion Histogram
```{r Inversion historgram}
c_inversion<- c(currentDataFrame$Num.of.Inversions)

c_names <- c(currentDataFrame$Name)
y <- c(currentDataFrame$Num.of.Inversions)

text <- c(currentDataFrame$Name)
data <- data.frame(c_names, c_inversion, text)

currentDataFrame %>%
  plot_ly(width = 700, height = 700,text = text,
        marker = list(color = ~c_names,
      size = 20)) %>%
  add_bars(x= ~c_names, y = ~c_inversion, color = ~c_names)
```


## Above 200ft in Coaster Histogram
```{r height historgram over 200}
c_year <- c(currentDataFrame$Year)
c_height <- c(currentDataFrame$Height)
c_types <- c(currentDataFrame$Type)

x <- c(currentDataFrame$Year)
y <- c(currentDataFrame$Height)

text <- c(currentDataFrame$Name)
data <- data.frame(c_year, c_height, text)

currentDataFrame %>%
  plot_ly(width = 700, height = 700,text = text,
        marker = list(color = ~c_types,
      size = 20)) %>%
  add_bars(x= ~c_year, y = ~c_height, color = ~c_types)

#![Superman Escape](path/to/your/image){width=250px}
```


## Popular Models
```{r Popularity}

df <- currentDataFrame %>% select(Manufacturer, Model.Name)
manufactures = c(df$Manufacturer)
listOfMan <- manufactures[!duplicated(manufactures)]

Models = length(listOfMan) + 1
Installations = 2
table <-data.frame(Models,Installations)

for(i in 1 : length(listOfMan))
{
    nextFrame <- df %>% filter(Manufacturer == listOfMan[i])
    nextlistOfMods <- nextFrame$Model.Name
    nextMode <- getmode(nextFrame$Model.Name)
    nextFreq <- countMode(nextlistOfMods)
    table[i,1] <- nextMode
    table[i,2] <- nextFreq
}
mods <- c(table$Models)            #x axis data v 
installs <- c(table$Installations) #y axis data v
text <- listOfMan
fig <- plot_ly(x = mods, y = installs, name = ~listOfMan, type = "bar", color = ~listOfMan, width = 8)
fig 

#Subset the data to make the graph above better to understand such as a Top 10 thingy
#tateFarmSubset <- subset(currentDataFrame, subset=((Height <= 70) & (manufactures == "State Farm Mut Grp")) , #select=c("AccidentYear","CumPaidLoss_B")) #data frame containing state farm paid losses (B) and accident years for development lags of 10

#table <- data.frame(table)
#class(table)
#table
#mtrx <- setNames(installs,mods) #set the table for every year's loss
#barplot(mtrx, xlab = "Model", ylab = "Num of Installations", main = "Installations ", col = rainbow(length(mods)),horiz = TRUE)

```

## Average Height From Each Manufacture
```{r Avg Height for each Manufacture}

df <- currentDataFrame %>% select(Manufacturer, Height)
ManufacturesNames = length(listOfMan) + 1
Avg_Height = 2
table <-data.frame(ManufacturesNames,Avg_Height)

for(i in 1 : length(listOfMan))
{
    nextFrame <- df %>% filter(Manufacturer == listOfMan[i])
    nextName <- listOfMan[i]
    nextAvg <- mean(nextFrame$Height)
    table[i,1] <- nextName
    table[i,2] <- nextAvg
}

names <- c(table$ManufacturesNames)            #x axis data v 
heights <- c(table$Avg_Height) #y axis data v
text <- listOfMan
fig <- plot_ly(x = names, y = heights, name = ~listOfMan, type = "bar", color = ~listOfMan, width = 8)
fig 
```

## Average Speed from each Manufacture
```{r Avg Speed for each Manufacture}

df <- currentDataFrame %>% select(Manufacturer, Speed)
ManufacturesNames = length(listOfMan) + 1
Avg_Speed = 2
table <-data.frame(ManufacturesNames,Avg_Speed)

for(i in 1 : length(listOfMan))
{
    nextFrame <- df %>% filter(Manufacturer == listOfMan[i])
    nextName <- listOfMan[i]
    nextAvg <- mean(nextFrame$Speed)
    table[i,1] <- nextName
    table[i,2] <- nextAvg
}

names <- c(table$ManufacturesNames)            #x axis data v 
speeds <- c(table$Avg_Speed) #y axis data v
text <- listOfMan
fig <- plot_ly(x = names, y = speeds, name = ~listOfMan, type = "bar", color = ~listOfMan, width = 8)
fig 
```

## Popular Models in different eras
```{r Popular Models within eras}

#1920-1960
df <- currentDataFrame %>% select(Year,Manufacturer, Model.Name) %>% filter(Year >= 1920 & Year <= 1960)
manufactures = c(df$Manufacturer)
listOfMan <- manufactures[!duplicated(manufactures)]

Models = length(listOfMan) + 1
Installations = 2
table <-data.frame(Models,Installations)

for(i in 1 : length(listOfMan))
{
    nextFrame <- df %>% filter(Manufacturer == listOfMan[i])
    nextlistOfMods <- nextFrame$Model.Name
    nextMode <- getmode(nextFrame$Model.Name)
    nextFreq <- countMode(nextlistOfMods)
    table[i,1] <- nextMode
    table[i,2] <- nextFreq
}
mods <- c(table$Models)            #x axis data v 
installs <- c(table$Installations) #y axis data v
text <- listOfMan
fig <- plot_ly(x = mods, y = installs, name = ~listOfMan, type = "bar", color = ~listOfMan, width = 8) %>% layout(title = "1920-1960")
fig 






#1961-1980
df <- currentDataFrame %>% select(Year,Manufacturer, Model.Name) %>% filter(Year >= 1961 & Year <= 1980)
manufactures = c(df$Manufacturer)
listOfMan <- manufactures[!duplicated(manufactures)]

Models = length(listOfMan) + 1
Installations = 2
table <-data.frame(Models,Installations)

for(i in 1 : length(listOfMan))
{
    nextFrame <- df %>% filter(Manufacturer == listOfMan[i])
    nextlistOfMods <- nextFrame$Model.Name
    nextMode <- getmode(nextFrame$Model.Name)
    nextFreq <- countMode(nextlistOfMods)
    table[i,1] <- nextMode
    table[i,2] <- nextFreq
}
mods <- c(table$Models)            #x axis data v 
installs <- c(table$Installations) #y axis data v
text <- listOfMan
fig <- plot_ly(x = mods, y = installs, name = ~listOfMan, type = "bar", color = ~listOfMan, width = 8) %>% layout(title = "1961-1980")
fig 






#1980-1999
df <- currentDataFrame %>% select(Year,Manufacturer, Model.Name) %>% filter(Year >= 1980 & Year <= 1999)
manufactures = c(df$Manufacturer)
listOfMan <- manufactures[!duplicated(manufactures)]

Models = length(listOfMan) + 1
Installations = 2
table <-data.frame(Models,Installations)

for(i in 1 : length(listOfMan))
{
    nextFrame <- df %>% filter(Manufacturer == listOfMan[i])
    nextlistOfMods <- nextFrame$Model.Name
    nextMode <- getmode(nextFrame$Model.Name)
    nextFreq <- countMode(nextlistOfMods)
    table[i,1] <- nextMode
    table[i,2] <- nextFreq
}
mods <- c(table$Models)            #x axis data v 
installs <- c(table$Installations) #y axis data v
text <- listOfMan
fig <- plot_ly(x = mods, y = installs, name = ~listOfMan, type = "bar", color = ~listOfMan, width = 8) %>% layout(title = "1980-1999")
fig 





#2000-Present
df <- currentDataFrame %>% select(Year,Manufacturer, Model.Name) %>% filter(Year >= 2000)
manufactures = c(df$Manufacturer)
listOfMan <- manufactures[!duplicated(manufactures)]

Models = length(listOfMan) + 1
Installations = 2
table <-data.frame(Models,Installations)

for(i in 1 : length(listOfMan))
{
    nextFrame <- df %>% filter(Manufacturer == listOfMan[i])
    nextlistOfMods <- nextFrame$Model.Name
    nextMode <- getmode(nextFrame$Model.Name)
    nextFreq <- countMode(nextlistOfMods)
    table[i,1] <- nextMode
    table[i,2] <- nextFreq
}
mods <- c(table$Models)            #x axis data v 
installs <- c(table$Installations) #y axis data v
text <- listOfMan
fig <- plot_ly(x = mods, y = installs, name = ~listOfMan, type = "bar", color = ~listOfMan, width = 8) %>% layout(title = "1990-2000")
fig 


```

## parks with the most coasters
```{r Parks with the most coasters}

```



## My ten favorite coasters compared

<center>

### 10. B&M's Old School Invert: Flight Deck 
![](https://siliconvalleycentral.files.wordpress.com/2014/04/flight-deck-red11.jpg){width=70%}
![](https://www.youtube.com/watch?v=eS3ZAMVI4-Q&feature=emb_logo)


### 9. Dynamic Structure's: Space Mountain 
![](https://www.themeparktribune.com/wp-content/uploads/2020/09/Space-Mountain-Disneyland-Disney.jpg){width=80%}
![](https://www.youtube.com/watch?v=e-Z0kd2l88Y)

### 8. Arrow's Remaining and Largest Multi-Looper: Viper
![](https://www.ultimaterollercoaster.com/coasters/pictures/viper/img/six-flags-magic-mountain-viper_8781.jpg)
![](https://www.youtube.com/watch?v=PXRVqSmXKO0)


### 7. Some of CCI's Best Work: Ghostrider 
![](https://www.ocregister.com/wp-content/uploads/migration/ntc/ntc3rq-b88490469z.120150819074525000gmfbga38.10.jpg){width=80%}
![](https://www.youtube.com/watch?v=aU3ZF0_Shv4&t=93s)


### 6. GCI Masterpiece: Gold Striker
![](https://i.pinimg.com/originals/34/bc/c0/34bcc0f277e29aed66d60911669ae1af.jpg){width=80%}
![](https://www.youtube.com/watch?v=wRjMvK61tes)


### 5. B&M's Ambitious Flying Coaster: Tatsu 
![](https://coastercritic.com/wp-content/uploads/2009/09/tatsu-magic-mountain-layout-700x400.jpg)
![](https://www.youtube.com/watch?v=ciSo2vhcmQE&t=21s)


### 4. Intamin's Hydraulic Protoype: Xcelerator 
![](https://i.pinimg.com/originals/9f/39/30/9f3930eaa429250b36bd9e17d472c597.jpg)
![](https://www.youtube.com/watch?v=jrtZKhGOQYo)


### 3. Arrow's 4th Dimension Protype: X2 
![](https://i.pinimg.com/originals/53/d7/fe/53d7fec4689cc6c1a7a5b6206cf06abf.jpg){width=90%}
![](https://www.youtube.com/watch?v=W20Hc7YELmk)




### 2. RMC's Protype Single Rail: Railblazer

![](http://www.negative-g.com/californias-great-america/2019/californias-great-america-2019-railblazer-30.jpg)
![](https://www.youtube.com/watch?v=k2OhRWz2VY4&t=1s)




### 1. RMC's Dualing IBOX: Twisted Colossus  
![](https://www.dailynews.com/wp-content/uploads/migration/2015/201505/NEWS_150529952_AR_0_OQZBWKLMXOLO.jpg){width=90%}
![](https://www.youtube.com/watch?v=JIcQOV6azSI)


### Favorites by the numbers 
```{r Favorites}
# Speed Historgram
Targets <- c("Twisted Colossus", "Viper", "Space Mountain", "GhostRider", "Gold Striker", "Flight Deck", "Railblazer", "X2", "Xcelerator", "Tatsu")
filteredDataFrame <- currentDataFrame %>% filter(Name %in% Targets) 
barplot <- ggplot(data = filteredDataFrame, width = 700, height = 700,mapping = aes(x = Year, y = Speed, 
             text = paste(
             Name, " at ", Park, "\n", 
                "Description: ", Type ,"", Model.Name, "\n",
                "Built by", Manufacturer, " in ", Year,"\n",
             Speed, " mph\n"))) + geom_bar(stat="identity", fill="yellow") + labs(title = "Speed Historgram After 1980")
ggplotly(barplot, tooltip = "text") 

# Height Historgram
barplot <- ggplot(data = filteredDataFrame, width = 700, height = 700,mapping = aes(x = Year, y = Height, 
             text = paste(
             Name, " at ", Park, "\n", 
                "Description: ", Type ,"", Model.Name, "\n",
                "Built by", Manufacturer, " in ", Year,"\n",
             Speed, " ft\n"))) + geom_bar(stat="identity", fill= "blue") + labs(title = "Height Historgram After 1980")
ggplotly(barplot, tooltip = "text") 

# Length Historgram
barplot <- ggplot(data = filteredDataFrame, width = 700, height = 700,mapping = aes(x = Year, y = Length, 
             text = paste(
             Name, " at ", Park, "\n", 
                "Description: ", Type ,"", Model.Name, "\n",
                "Built by", Manufacturer, " in ", Year,"\n",
             Speed, " ft\n"))) + geom_bar(stat="identity", fill= "red") + labs(title = "Length Historgram After 1980")
ggplotly(barplot, tooltip = "text") 

```


## Sources
Data Sources				
https://rcdb.com/r.htm?ot=2&ex&ol=1499				CA existant coasters according to RCDB
More info on Big Thunder https://en.wikipedia.org/wiki/Big_Thunder_Mountain_Railroad				
https://stg.statcrunch.com/app/index.php?dataid=2188685				
https://www.youtube.com/watch?v=FfDonRPuYZg				Coastersaurus
https://www.youtube.com/watch?v=QIG3wVbR6pw				 Canyon Blaster
https://rcdb.com/r.htm?ot=2&mo=8280				Coast Rider
https://rcdb.com/4003.htm			Same model as cobra	
https://sbfrides.com/products/spinning-coaster/				 SBF Visa Spinning coaster
https://www.youtube.com/watch?v=W8oEo96_QnU				 Dragon Legoland
https://coasterpedia.net/wiki/Dragon_(Legoland_California)				
https://rcdb.com/1478.htm			Same model as Goofy's Sky School	
https://en.wikipedia.org/wiki/The_Grizzly				
https://en.wikipedia.org/wiki/Incredicoaster				
https://en.wikipedia.org/wiki/Matterhorn_Bobsleds				
https://en.wikipedia.org/wiki/Space_Mountain_(Disneyland)				
https://www.ultimaterollercoaster.com/coasters/timber-twister		


